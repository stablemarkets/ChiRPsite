---
title: "Chinese Restaurant Process Mixture Models"
output:
  html_document:
    toc: true
    toc_float: true
---

<script>
   $(document).ready(function() {
     $head = $('#header');
     $head.prepend('<img src=\"logo.png\" style=\"float: right;width: 150px;\"/>')
   });
</script>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The Generative Model
The package implements the following generative Chinese Restaurant Process (CRP) regression mixture. For data $D = (y_i, x_i)_{i=1:n}$, where $x$ is a $p \times 1$ covariate vector (including an intercept) and $y_i$ is a scalar outcome observed for $n$ subjects indexed by $i$. The full probability model is given by
$$ \begin{aligned}
y_i | x_i, \eta_y & \sim f_y(y_i|x_i, \eta_i) \\
      x_i | \theta_i & \sim f_x(x_i | \theta_i ) \\
      \eta_i, \theta_i | G & \sim G \\
      G & \sim DP(\alpha G_0)
\end{aligned}
$$
Above, $f_y$ is the conditional distribution of the outcome. It is governed by parameters $\eta_i$. The joint distribution of the covariates, $f_x$, is governed by $\theta_i$. These parameters are distributed according to an unknown distribution $G$, to which we assign a [Dirichlet Process](https://stablemarkets.shinyapps.io/dpmixapp/) (DP) prior. Since draws, $G$, from a DP are discrete, there are bound to be ties among the subject specific parameters $(\eta_i, \theta_i)$. That is, subjects will tend to cluster together. The number of clusters is not set **a priori**, but rather infinitely many clusters are assumed.

This induced clustering partitions complex data into more homogenous subgroups - each with their own set of regression parameters. This allows CRP models to obtain flexible fits where parametric models may fail.

Package implementation details:

* All models accomodate any number of binary and continuous covariates *only*. Categorical variables are not supported (yet).
* All models assume independence among covariates: $f_x(x_i) = \prod_{j=1}^p f_{x^p}(x_i^p|\theta_i^p)$
    + $f_{x^p}$ is set to be Bernoulli for binary covariates and Gaussian, $N(\lambda, \tau)$ for continuous covariates
* Hyperparameters
    + Concentration parameter, $\alpha$, is estimated with a $Gam(1,1)$ prior.
    + For continuous covariates, we use hyperpriors $\lambda \sim N(\mu, var=\sigma)$ and $\tau \sim InvGamma(shape=g_1, rate=b_1)$
    
## Supported Outcome Models
### Zero-Inflated Outcomes with `ZDPMix()`
### Continuous Outcomes `NDPMix()`
### Binary Outcomes `PDPMix()`

## Posterior Clustering
### The Chinese Restaurant Process
Let $c_{1:n}$ represent a vector of cluster indicators for the $n$ subjects. Since the DP prior induces a clustering on patients, we can make inference on $c_{1:n}$. All functions in the model output posterior cluster assignments.

## Posterior Mode Cluster Assignment
Adjacency Matrices.

## Predictive Distribution
Polya Urn Scheme for Preditions.

## References
